{"version":3,"sources":["src\\utils\\react_bus.js"],"names":["Function","prototype","bind","self","args","Array","slice","call","arguments","apply","ReactBus","listeners","counts","emit","length","e","shift","ls","i","handle","event","concat","on","fn","indexOf","push","once","stub","off","newLs"],"mappings":"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","file":"react_bus.js","sourceRoot":"C:/Users/liu.ping/helloReact","sourcesContent":["// a shim for bind\r\nif (typeof Function.prototype.bind !== \"function\") {\r\n  Function.prototype.bind = function (bind) {\r\n      var self = this;\r\n      return function () {\r\n          var args = Array.prototype.slice.call(arguments);\r\n          return self.apply(bind || null, args);\r\n      };\r\n  };\r\n}\r\n\r\nvar ReactBus = function() {\r\n  this.listeners = {};\r\n\r\n  this.counts = {\r\n    \"_drop\": 0, // convenient so we don't have to test against `undefined`\r\n    // to check whether we have dropped any events.\r\n    \"_all\": 0\r\n  };\r\n};\r\n\r\nReactBus.prototype.emit = function() {\r\n  var args = Array.prototype.slice.call(arguments, 0);\r\n  if (args.length < 1) { return; }\r\n  var e = args.shift();\r\n\r\n  // count every event, even though they might not have been caught.\r\n  this.counts[e] = this.counts[e] ? this.counts[e] + 1 : 1;\r\n\r\n  if (!this.listeners[e]) {\r\n    // don't register a drop on \"_drop\" or \"_all\"\r\n    if (e !== \"_drop\" && e !== \"_all\") {\r\n      this.emit(\"_drop\", e, args);\r\n    }\r\n  }\r\n\r\n  var ls = this.listeners[e] || [];\r\n  for (var i = 0; i < ls.length; i += 1) {\r\n    if (typeof ls[i] === \"function\") {\r\n      ls[i].apply(this, args);\r\n    }\r\n  }\r\n\r\n  // register an \"_all\" event when the event is not \"_all\" or \"_drop\".\r\n  if (e !== \"_all\" && e !== \"_drop\") {\r\n    this.emit(\"_all\", e, args);\r\n  }\r\n};\r\n\r\n// partially applied function, good for DOM event handlers.\r\nReactBus.prototype.handle = function() {\r\n  var args = Array.prototype.slice.call(arguments, 0);\r\n\r\n  return function(event) {\r\n    this.emit.apply(this, args.concat([event]));\r\n  }.bind(this);\r\n};\r\n\r\nReactBus.prototype.on = function(e, fn) {\r\n  if (this.listeners[e]) {\r\n    // don't add duplicates.\r\n    if (this.listeners[e].indexOf(fn) !== -1) { return; }\r\n\r\n    return this.listeners[e].push(fn);\r\n  }\r\n\r\n  this.listeners[e] = [fn];\r\n};\r\n\r\n// this is mainly used for testing.\r\nReactBus.prototype.once = function(e, fn) {\r\n  var stub = function() {\r\n    fn.apply(this, arguments);\r\n    this.off(e, stub);\r\n  }.bind(this);\r\n\r\n  this.on(e, stub);\r\n};\r\n\r\nReactBus.prototype.off = function(e, fn) {\r\n  if (!this.listeners[e]) { return; }\r\n\r\n  // if no function was passed, delete all event handlers of `e`.\r\n  if (typeof fn === \"undefined\") {\r\n    delete this.listeners[e];\r\n    return;\r\n  }\r\n\r\n  var ls = this.listeners[e];\r\n  var newLs = [];\r\n\r\n  // filter out `fn`, I don't use `delete` because it creates gaps.\r\n  for (var i = 0; i < ls.length; i += 1) {\r\n    if (ls[i] !== fn) {\r\n      newLs.push(ls[i]);\r\n    }\r\n  }\r\n\r\n  if (newLs.length > 0) {\r\n    this.listeners[e] = newLs;\r\n  } else {\r\n    // if there are no handlers left just remove the entire entry.\r\n    delete this.listeners[e];\r\n  }\r\n};\r\n\r\n\r\nexport default ReactBus"]}