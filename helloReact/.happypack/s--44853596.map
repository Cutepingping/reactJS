{"version":3,"sources":["src\\widget\\Category\\Category.jsx"],"names":["TreeNode","Search","Category","categoryList","contentHeight","autoExpandParent","searchValue","expandedKeys","children","selectedKeys","selectCategory","leftSpan","rightSpan","width","dispatch","nameSpace","originalCategoryList","deleteItem","create","pageConfig","sort","isSort","isFinalNode","genTreeTitle","title","item","height","id","style","btnContent","e","stopPropagation","btnFirst","btn","loop","data","map","key","name","index","search","beforeStr","substr","afterStr","length","color","getParentKey","tree","parentKey","i","node","some","onSearch","v","value","_","trim","isEmpty","error","type","payload","isReExpand","page","pageChange","pageSize","content","conetentLeft","area1","area2","pagination","current","total","size","conetentRight"],"mappings":"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","file":"Category.jsx","sourceRoot":"C:/Users/liu.ping/helloReact","sourcesContent":["/**\r\n * @(#)Category.jsx 0.5.1 2017-09-13\r\n * Copyright (c) 2017, YUNXI. All rights reserved.\r\n * YUNXI PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.\r\n */\r\nimport React, {PropTypes} from 'react'\r\nimport {\r\n  Tree, Input, Button, Row, Col, Form, Modal, Popconfirm, Select, Icon, Upload, message, Checkbox, Pagination, Popover\r\n} from 'antd';\r\nimport _ from 'lodash'\r\nimport style from './Category.less'\r\nimport cx from 'classnames'\r\n\r\nconst TreeNode = Tree.TreeNode;\r\nconst Search = Input.Search;\r\n\r\n/*\r\n * 类目树\r\n *\r\n * @author 苏离\r\n * @since 0.5.1\r\n */\r\nexport const Category = ({\r\n     categoryList, contentHeight, autoExpandParent, searchValue, expandedKeys, children, selectedKeys,\r\n     selectCategory, leftSpan, rightSpan, width, dispatch, nameSpace, originalCategoryList, deleteItem,\r\n     create, pageConfig, sort, isSort, isFinalNode\r\n   }) => {\r\n\r\n  // 自定义树形title\r\n  function genTreeTitle(title, item) {\r\n    return (\r\n      <div style={{height: '24px'}}>\r\n        <Popover placement=\"leftTop\" content={item.id === '0'\r\n          ? <span className={cx(style.btnContent)}>\r\n              <Button onClick={(e) => {\r\n                // 阻止事件冒泡\r\n                e.stopPropagation();\r\n                create(item.id)\r\n              }}>\r\n                <Icon type=\"plus\"/>新增\r\n              </Button>\r\n            </span>\r\n          : <span className={cx(style.btnContent)}>\r\n            {\r\n              //如果是最后节点，不予许新增\r\n              isFinalNode && isFinalNode(item) && <p>\r\n                <Button className={style.btnFirst} onClick={(e) => {\r\n                // 阻止事件冒泡\r\n                e.stopPropagation();\r\n                create(item.id)\r\n              }}><Icon type=\"plus\"/>新增</Button></p>\r\n            }\r\n              <p>\r\n                <Popconfirm Collapse title={`确定要删除吗？`} okText='确定' cancelText='取消' onConfirm={() =>deleteItem(item.id)}>\r\n                    <Button className={cx(style.btn, 'mg1t')} onClick={(e) => {\r\n                      // 阻止事件冒泡\r\n                      e.stopPropagation();\r\n                    }}><Icon type=\"delete\"/>删除\r\n                    </Button>\r\n                </Popconfirm>\r\n              </p>\r\n            {/*-2置底，-1下移，1上移，2置顶*/}\r\n            {\r\n              isSort && <span>\r\n                    <p>\r\n                      <Button className={cx(style.btn, 'mg1t')} onClick={(e) => {\r\n                        // 阻止事件冒泡\r\n                        e.stopPropagation();\r\n                        sort(item.id, 1)\r\n                      }}><i className=\"iconfont icon-shu-shangyi\"></i>上移</Button>\r\n                    </p>\r\n                    <p>\r\n                      <Button className={cx(style.btn, 'mg1t')} onClick={(e) => {\r\n                        // 阻止事件冒泡\r\n                        e.stopPropagation();\r\n                        sort(item.id, -1)\r\n                      }}><i className=\"iconfont icon-shu-xiayi\"></i>下移</Button>\r\n                    </p>\r\n                    <p>\r\n                      <Button className={cx(style.btn, 'mg1t')} onClick={(e) => {\r\n                        // 阻止事件冒泡\r\n                        e.stopPropagation();\r\n                        sort(item.id, 2)\r\n                      }}><i className=\"iconfont icon-shu-zhiding\"></i>置顶</Button>\r\n                    </p>\r\n                    <p>\r\n                      <Button className={cx(style.btn, 'mg1t')} onClick={(e) => {\r\n                        // 阻止事件冒泡\r\n                        sort(item.id, -2)\r\n                      }}><i className=\"iconfont icon-shu-zhidi\"></i>置底</Button>\r\n                    </p>\r\n                  </span>\r\n            }\r\n              </span>} title={null}>\r\n          <span>{title}</span>\r\n        </Popover>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  function loop(data) {\r\n    return data.map((item) => {\r\n      item.key = item.id + '';\r\n      const name = item.name;\r\n      const index = name.search(searchValue);\r\n      const beforeStr = name.substr(0, index);\r\n      const afterStr = name.substr(index + searchValue.length);\r\n      const title = index > -1 ? (\r\n        <span>\r\n        {beforeStr}\r\n          <span style={{color: '#f50'}}>{searchValue}</span>\r\n          {afterStr}\r\n      </span>\r\n      ) : <span>{name}</span>;\r\n      if (item.children) {\r\n        return (\r\n          <TreeNode key={item.id} title={genTreeTitle(title, item)}>\r\n            {loop(item.children)}\r\n          </TreeNode>\r\n        );\r\n      }\r\n      return <TreeNode key={item.id} title={genTreeTitle(title, item)}/>;\r\n    })\r\n  };\r\n\r\n  function getParentKey(key, tree) {\r\n    let parentKey;\r\n    for (let i = 0; i < tree.length; i++) {\r\n      const node = tree[i];\r\n      if (node.children) {\r\n        if (node.children.some(item => item.name === key)) {\r\n          parentKey = node.key;\r\n        } else if (getParentKey(key, node.children)) {\r\n          parentKey = getParentKey(key, node.children);\r\n        }\r\n      }\r\n    }\r\n    return parentKey;\r\n  };\r\n\r\n  function onSearch(v) {\r\n    let value = _.trim(v);\r\n    if (_.isEmpty(originalCategoryList)) {\r\n      _.isEmpty(originalCategoryList) && message.error('没有数据！');\r\n      return;\r\n    }\r\n    dispatch({\r\n      type: `${nameSpace}/pageChange`,\r\n      payload: { searchValue: _.trim(value), isReExpand: true, page: 1}\r\n    })\r\n  }\r\n\r\n  function pageChange(page, pageSize) {\r\n    dispatch({type: `${nameSpace}/pageChange`, payload: {page}})\r\n  }\r\n\r\n  return (\r\n    <div className={cx('txtcenter')}>\r\n      <Row style={{width}} className={cx(style.content, 'iblock', 'txtleft')}>\r\n        <Col span={leftSpan} className={style.conetentLeft}>\r\n          <div className={style.area1}>\r\n            <Search style={{width: '100%'}} placeholder=\"搜索\" onSearch={onSearch}/>\r\n            <div className=\"mg2t text-info\">\r\n              <Icon type=\"exclamation-circle fsize14\"/> 点击节点可显示详情\r\n            </div>\r\n          </div>\r\n          <div className={style.area2}>\r\n            <div className={style.tree} style={{height: contentHeight}}>\r\n              <Tree onSelect={selectCategory} autoExpandParent={autoExpandParent} selectedKeys={selectedKeys}\r\n                onExpand={expandedKeys => dispatch({\r\n                  type: `${nameSpace}/updateStore`,\r\n                  payload: {expandedKeys, autoExpandParent: false}\r\n                })}\r\n                expandedKeys={expandedKeys} showLine>\r\n                {loop(categoryList)}\r\n              </Tree>\r\n            </div>\r\n          </div>\r\n          <div className={cx('txtcenter', 'mg2b', style.pagination)}>\r\n            <Pagination simple onChange={pageChange} current={pageConfig.current} total={pageConfig.total}\r\n              defaultPageSize={pageConfig.size}/>\r\n          </div>\r\n        </Col>\r\n        <Col span={rightSpan} className={cx(style.conetentRight, 'treeRight')}>\r\n          {children}\r\n        </Col>\r\n      </Row>\r\n    </div>\r\n  )\r\n}\r\n"]}