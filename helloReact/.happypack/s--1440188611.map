{"version":3,"sources":["src\\widget\\ContextMenu\\ContextMenu.js"],"names":["props","context","state","showMenu","style","menuList","nextProps","setState","e","preventDefault","stopPropagation","nativeEvent","stopImmediatePropagation","self","width","left","top","clientX","clientY","window","addEventListener","closeMenuItem","i","handleClick","flag","length","map","m","j","cls","styles","reactContextmenuItem","reactContextmenuItemSelected","toggleMenuItem","reactContextmenu","reactContextmenuVisible","reactContextmenuItemDivider","reactContextmenuWrapper","React","Children","children","child","cloneElement","onContextMenu","navCls","onMouseOver","onMouseOut","onMenuChange","text","itemDivider","renderBody","Component"],"mappings":"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","file":"ContextMenu.js","sourceRoot":"C:/Users/liu.ping/helloReact","sourcesContent":["// 引入React库\r\nimport React, {Component} from 'react'\r\n\r\n// 显示多个样式类名\r\nimport cx from 'classnames'\r\n// 引入组件样式\r\nimport styles from './ContextMenu.less'\r\n\r\n// 右键组件\r\nexport default class extends Component{\r\n  // 构造函数\r\n  constructor(props, context) {\r\n    super(props, context)\r\n    this.state = {\r\n      // 是否展示菜单\r\n      showMenu: false,\r\n      // 菜单样式\r\n      style: {},\r\n      // 菜单项\r\n      menuList: []\r\n    }\r\n  }\r\n\r\n  //准备：即将被重新渲染，状态未变化\r\n  componentWillMount() {}\r\n\r\n  // 已加载组件，收到新属性时调用\r\n  componentWillReceiveProps(nextProps) {\r\n    if(!nextProps.menuList) return false\r\n    this.setState({\r\n      menuList: nextProps.menuList\r\n    })\r\n  }\r\n\r\n  // 已插入真实DOM\r\n  componentDidMount() {\r\n    if(!this.props.menuList) return false\r\n    this.setState({\r\n      menuList: this.props.menuList\r\n    })\r\n  }\r\n\r\n  // 阻止事件冒泡\r\n  stopPropagation(e){\r\n    // 取消默认的浏览器自带右键\r\n    e.preventDefault();\r\n    // 阻止事件冒泡\r\n    e.stopPropagation();\r\n    // 阻止React本地事件冒泡\r\n    e.nativeEvent.stopImmediatePropagation()\r\n  }\r\n\r\n  // 关闭菜单\r\n  closeMenuItem(){\r\n    // 作用域提升\r\n    let self = this\r\n    // 隐藏菜单\r\n    self.setState({\r\n      showMenu: false,\r\n      style: {\r\n        width: '0px',\r\n        left: '0px',\r\n        top: '0px'\r\n      }\r\n    })\r\n  }\r\n\r\n  // 右键触发打开菜单\r\n  onContextMenu(e){\r\n    // 作用域提升\r\n    let self = this\r\n    // 阻止冒泡\r\n    self.stopPropagation(e)\r\n\r\n    // 菜单样式\r\n    let {style} = this.state\r\n\r\n    style.width = style.width || '160px'\r\n    style.left = (e.clientX || 0) + 'px'\r\n    style.top = (e.clientY || 0) + 'px'\r\n\r\n    // 展示菜单\r\n    self.setState({\r\n      showMenu: true,\r\n      style\r\n    })\r\n\r\n    // 监听窗体点击事件，点击则关闭菜单\r\n    window.addEventListener('click', () => self.closeMenuItem(), false)\r\n  }\r\n\r\n  // 点击菜单\r\n  onMenuChange(e, i, handleClick){\r\n    // 作用域提升\r\n    let self = this\r\n    // 阻止冒泡\r\n    self.stopPropagation(e)\r\n    // 关闭菜单\r\n    self.closeMenuItem()\r\n\r\n    // 触发回调\r\n    if(!!handleClick){\r\n      handleClick(i)\r\n    }\r\n  }\r\n\r\n  // 菜单切换\r\n  toggleMenuItem(i, flag){\r\n    // 作用域提升\r\n    let self = this\r\n    // 菜单列表\r\n    let {menuList} = self.state\r\n\r\n    // 菜单为空\r\n    if(0 === menuList.length) return false\r\n\r\n    // 遍历菜单\r\n    menuList.map((m, j) => {\r\n      if('' + i === '' + j){\r\n        if(flag){\r\n          m.cls = cx(styles.reactContextmenuItem, styles.reactContextmenuItemSelected)\r\n        }else{\r\n          m.cls = cx(styles.reactContextmenuItem)\r\n        }\r\n        return\r\n      }\r\n    })\r\n    self.setState({menuList})\r\n    return false\r\n  }\r\n\r\n  // 鼠标移过事件\r\n  onMouseOver(e, i){\r\n    // 作用域提升\r\n    let self = this\r\n    // 阻止冒泡\r\n    self.stopPropagation(e)\r\n    // 高亮\r\n    self.toggleMenuItem(i, true)\r\n    return false\r\n  }\r\n\r\n  // 鼠标移出事件\r\n  onMouseOut(e, i){\r\n    // 作用域提升\r\n    let self = this\r\n    self.stopPropagation(e)\r\n    // 恢复\r\n    self.toggleMenuItem(i, false)\r\n  }\r\n\r\n  // 菜单栏样式\r\n  navCls(){\r\n    return cx(styles.reactContextmenu, this.state.showMenu? styles.reactContextmenuVisible: '')\r\n  }\r\n\r\n  // 分割条样式\r\n  itemDivider(){\r\n    return cx(styles.reactContextmenuItem, styles.reactContextmenuItemDivider)\r\n  }\r\n\r\n  renderBody(){\r\n    return (\r\n      <div>\r\n        <div className={styles.reactContextmenuWrapper}>\r\n          {\r\n            React.Children.map(this.props.children, (child, i) => {\r\n              return React.cloneElement(child, {onContextMenu: e => this.onContextMenu(e)})\r\n            })\r\n          }\r\n        </div>\r\n        <nav className={ this.navCls() } style={this.state.style}>\r\n          {\r\n            this.state.menuList && this.state.menuList.map((m, i) => {\r\n              return (\r\n                <div key={'menu_item_' + i}>\r\n                  <div className={ cx(m.cls) || cx(styles.reactContextmenuItem)}\r\n                    onMouseOver={ e => this.onMouseOver(e, i)}\r\n                    onMouseOut={ e => this.onMouseOut(e, i) }\r\n                    onClick={e => this.onMenuChange(e, i, m.handleClick)}\r\n                  >\r\n                    <span>{m.text}</span>\r\n                  </div>\r\n                  {\r\n                    i !== this.state.menuList.length - 1 && (\r\n                      <div className={ this.itemDivider()}></div>\r\n                    )\r\n                  }\r\n                </div>\r\n              )\r\n            })\r\n          }\r\n        </nav>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  // 渲染函数\r\n  render() {\r\n    return this.renderBody()\r\n  }\r\n\r\n}\r\n"]}